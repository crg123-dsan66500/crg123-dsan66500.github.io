---
title: "Reward Misalignment in Deep Reinforcement Learning: Evidence from a Bakery Production Environment"
author: "Courtney Green"
date: "2025-12-02"
format:
  html:
    toc: true
    embed-resources: true
---

## Abstract

This project examines reward–behavior alignment in a capacity‑constrained production setting. A custom “Bellman’s Bakery” environment models a single day with two ovens, stochastic arrivals, patience/abandonment, and five products. PPO and QRDQN are evaluated against heuristics. Under a shaped reward that heavily penalizes leftovers and delay, learning converges to conservative policies that under‑produce to avoid waste. Pricing adjustments provide limited leverage because oven throughput is the binding constraint. Profit‑aligned evaluation yields modest increases in service and profit but does not remove the bottleneck. Findings highlight that reward design and structural constraints dominate performance more than the specific deep RL algorithm.

## Demo

A short viewer clip of one simulated day (Newsvendor baseline) is embedded below.

<video controls src="../videos/viewer_index_demo.mp4" width="720">
  Your browser does not support the video tag.
</video>

<p style="margin-top:6px;color:#666;">Clip shows baking/serving decisions, oven progress, queue, and current action.</p>

Quickstart and viewer controls are documented in the project README.

## Overview

Bellman’s Bakery is a pastel, “tiny bakery tycoon” environment used to study reward–behavior alignment in deep RL. Each episode is a single day with two ovens, five products, stochastic arrivals, and customer patience/abandonment. The work evaluates PPO and QRDQN alongside simple baselines and price bandits under capacity constraints.

At a glance:

- Environment: two-oven production with queueing, bake times, sizes, and yields.
- Algorithms: PPO (masking) and QRDQN; bandit pricing for daily multipliers.
- Baselines: newsvendor, bake‑to‑par, greedy‑queue.
- Key finding: shaped rewards that over‑penalize leftovers/delay lead to conservative, under‑producing policies; pricing has limited leverage under throughput bottlenecks.

Run locally (viewer):

```powershell
python -m scripts.run_viewer --model models/best_ppo.zip
# or run a baseline without a model:
python -m scripts.run_viewer --baseline newsvendor
```

